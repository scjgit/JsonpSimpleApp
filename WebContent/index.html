<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Jsonp Example</title>
<script type="text/javascript" src="js/jquery-1.5.min.js"></script>
</head>
<body>
	<button onclick="getData();">call REST API</button>
	<br>
	<div id="restApiResult"></div>
	<br><br>
	<span>Server Sent Event Example</span>
	<div id="result"></div>

	<script type="text/javascript">
		function getData() {
			myUrl = 'http://localhost:8080/SpringRestApi/vehicleDetails';
			//myUrl = 'http://148.162.216.26:9090/dejdss/restapi/vehicle?name=bmw&value=dsd';
			$.ajax({
				type : 'GET',
				url : myUrl,
				//async : false,
				//jsonpCallback: 'myFunc',
				jsonpCallback : 'myCallBack',
				contentType : 'appliaction/json',
				dataType : 'JSONP',
				data : {
					name : "BMW",
					value : "2131"
				},
				//success : myFunction,
				error : myFailureFunction
			});
		}

		function myFunction(data) {
			console.log("In myFunction()");
			console.log(data);
		}

		function myCallBack(data) {
			console.log("In myCallBack()");
			console.log(data);
			$("#restApiResult").text(data.vehicleName);
		}

		function myFailureFunction(data) {
			console.log("In myFailureFunction()");
			console.log(data);
		}
	</script>

	<script type="text/javascript">

	/**SSE Example - Start**/
		if (typeof (EventSource) !== "undefined") {
			var source = new EventSource("getServerData");
			
			/**What to do when a connection is opened*/
			source.onopen = function(event){
				//console.log("Connection Opened");
				//console.log(event);
				//$("#result").text("Message Type : "+event.type+" ,Time : "+event.timeStamp);
			};
			
			/**What to do when data is received*/
			source.onmessage = function(event) {
				//console.log("Message Recieved: ");console.log(event);
				$("#result").text("Message Type : "+event.type+" :: "+event.data);
			};
			
			/**What to do when an error is thrown*/
			source.onerror = function(message){
				//console.log("Error Recieved: ");console.log(message);
				//$("#result").text("Message Type : "+message.type+" ,Time : "+new Date(message.timeStamp));
			};
			
		} else {
			$("#result").text("Sorry, your browser does not support server-sent events...");
		}
	/**SSE Example - End**/
	
	</script>
</body>
</html>